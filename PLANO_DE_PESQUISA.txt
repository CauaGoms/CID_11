1_ Dividir JSON em 26 json com separações oficiais. [OK]
2_ Criar banco embbeding de cada um dos 26 jsons. [OK]

3_ Usar uma LLM para extrair, em cada prontuário, entidades que classifiquem dentre os 26 tipos de códigos CID com ajuda das próprias entidades do semclinbr. [OK]
4_ Usar o modelo mxbai-embed-large para passar a entidade extraída e o prontuário a qual pertence para retornar as 5 melhores opções de correspondência com a entidade.
4_ Guardar no json_variabilidade o processamento extra especificado logo a seguir.
5_ Usar uma LLM para decidir qual das 5 opções é a melhor
6_ Usar uma LLM para retirar o nome da entidade do texto do prontuário do jsonl e substituir por [DIAG_1] por exemplo
7_ Retornar o jsonl do prontuário no seguinte formato:


{
  "prontuario_id": 1,
  "text": ".. início de [DIAG_1] em calcâneo d..",
  "entities": {
    "Sinal ou Sintoma": ["sonolenta"],
    "Achado": ["Acamada", "Sudoréica"]
  },
  "labels": {
    "EH90": {
      "term_original": "início de em calcâneo d.",
      "capitulo": 2
      "confidence_embedding": 0.91,
      "is_inferred": False
      "classification_reasoning": "O texto descreve medidas preventivas e início de lesão em calcâneo, o que correlaciona diretamente com o código de úlcera de pressão/decúbito no capítulo correspondente do CID."
    }
  }
}


Processamento extra: Para aproveitar o processamento, a cada análise dos termos ele guardará em um json de variabilidade com essa estrutura:
{
  "L896": {
    "official_name": "Úlcera de decúbito e úlcera de pressão",
    "variations": [
      { "term": "início de em calcâneo d.", "frequency": 12, "id_prontuarios": [2, 43, 54, 68] },
      { "term": "lesão por pressão em região sacral", "frequency": 5, "id_prontuarios": [3, 32, 56, 89] }
    ]
  },
  "E118": {
    "official_name": "Diabetes mellitus não-insulino-dependente",
    "variations": [
      { "term": "controle glicêmico", "frequency": 45, "id_prontuarios": [2, 43, 54, 68] },
      { "term": "DM2", "frequency": 110, "id_prontuarios": [2, 43, 54, 68] }
    ]
  }
}


DESC_CAPITULOS = """
01_ Algumas doenças infecciosas ou parasitárias: Doenças causadas por agentes infecciosos como bactérias, vírus, parasitas e fungos.
02_ Neoplasias: Crescimento celular anormal e descontrolado, não compatível com as necessidades normais do organismo.
03_ Doenças do sangue ou dos órgãos formadores do sangue: Condições que afetam o sangue e os órgãos responsáveis por sua produção.
04_ Doenças do sistema imune: não há descrição complementar.
05_ Doenças endócrinas, nutricionais ou metabólicas: Distúrbios hormonais, nutricionais e metabólicos que afetam o funcionamento do organismo.
06_ Transtornos mentais, comportamentais ou do neurodesenvolvimento: Alterações clinicamente significativas da cognição, emoção ou comportamento, com impacto funcional.
07_ Transtornos de sono-vigília: Distúrbios relacionados à iniciação, manutenção ou regulação do sono e do ciclo sono-vigília.
08_ Doenças do sistema nervoso: Condições que afetam ou estão associadas ao sistema nervoso central ou periférico.
09_ Doenças do sistema visual: Doenças que acometem os olhos, vias visuais e áreas cerebrais relacionadas à visão.
10_ Doenças da orelha ou do processo mastoide: Condições que afetam a audição, o equilíbrio e estruturas associadas.
11_ Doenças do sistema circulatório: Doenças que afetam o coração, os vasos sanguíneos e o transporte de substâncias no organismo.
12_ Doenças do sistema respiratório: não há descrição complementar.
13_ Doenças do sistema digestivo: não há descrição complementar.
14_ Doenças da pele: Condições que afetam a pele, seus anexos, mucosas associadas e tecidos subjacentes.
15_ Doenças do sistema musculoesquelético ou do tecido conjuntivo: Doenças que afetam músculos, ossos, articulações e tecidos de sustentação.
16_ Doenças do sistema geniturinário: Condições que afetam os sistemas urinário e genital.
17_ Condições relacionadas à saúde sexual: não há descrição complementar.
18_ Gravidez, parto ou puerpério: Condições associadas à gestação, ao parto e ao período pós-parto.
19_ Algumas afecções originadas no período perinatal: Condições que têm origem no período perinatal, mesmo quando manifestadas posteriormente.
20_ Anomalias do desenvolvimento: Alterações estruturais ou funcionais decorrentes de falhas no desenvolvimento pré-natal.
21_ Sintomas, sinais ou achados clínicos, não classificados em outra parte: Sinais, sintomas e achados inespecíficos usados quando não há diagnóstico definitivo.
22_ Lesões, envenenamentos ou algumas outras consequências de causas externas: Danos corporais resultantes de agentes físicos, químicos ou da falta de elementos vitais.
23_ Causas externas de morbidade ou mortalidade: Classificação das circunstâncias e intenções que levam a lesões ou morte.
24_ Fatores que influenciam o estado de saúde ou o contato com serviços de saúde: Situações ou condições que afetam a saúde sem constituírem doença ou lesão.
25_ Códigos para propósitos especiais: não há descrição complementar.
26_ Capítulo Suplementar – Condições da Medicina Tradicional: não há descrição complementar.
V _ Seção suplementar para avaliação de funcionalidade: Instrumentos e categorias para avaliar e quantificar a funcionalidade e a incapacidade.
X _ Códigos de extensão: Códigos suplementares usados para detalhar ou complementar outras classificações, não utilizados como codificação primária."""